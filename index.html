<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script>```html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2024 選舉投票計算</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
  <div id="root"></div>
  <script type="text/babel">
    // 初始資料，來自 Excel
    const initialData = [
      { id: '案1', G: 1167, F: 0, A1: 1000, A2: 67, B: 0 },
      { id: '案2', G: 1168, F: 200, A1: 0, A2: 0, B: 0 },
      { id: '案3', G: 1147, F: 300, A1: 0, A2: 0, B: 0 },
      { id: '案4', G: 10, F: 0, A1: 0, A2: 0, B: 0 },
      { id: '案5', G: 9, F: 0, A1: 0, A2: 0, B: 0 },
    ];

    // 計算衍生值
    const calculateValues = (item) => {
      const E = item.G - item.F;
      const A = item.A1 + item.A2;
      const C = A + item.B;
      const D = item.G - item.F - C;
      const consistency = E === (C + D) ? '相符' : '不相符';
      return { ...item, E, A, C, D, consistency };
    };

    // 主 React 組件
    const App = () => {
      const [data, setData] = React.useState(initialData);
      const handleInputChange = (index, field, value) => {
        // 允許空字串和有效數字（包括 0）
        const newValue = value === '' ? '' : isNaN(parseInt(value)) ? 0 : parseInt(value);
        const newData = [...data];
        newData[index] = { ...newData[index], [field]: newValue };
        setData(newData);
      };

      const renderTopTable = () => {
        const calculatedData = data.map(calculateValues);
        return (
          <table className="table-auto w-full mb-8 border-collapse border border-gray-400">
            <thead>
              <tr className="bg-gray-200">
                <th className="border border-gray-400 p-2"></th>
                {data.map((item, index) => (
                  <th key={index} className="border border-gray-400 p-2">{item.id}</th>
                ))}
              </tr>
            </thead>
            <tbody>
              <tr>
                <td className="border border-gray-400 p-2">（G）投票權人數，手動輸入</td>
                {data.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">
                    <input
                      type="number"
                      value={item.G === '' ? '' : item.G}
                      onChange={(e) => handleInputChange(index, 'G', e.target.value)}
                      className="w-full bg-red-200 p-1 text-center"
                    />
                  </td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（F）用餘票數，手動輸入</td>
                {data.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">
                    <input
                      type="number"
                      value={item.F === '' ? '' : item.F}
                      onChange={(e) => handleInputChange(index, 'F', e.target.value)}
                      className="w-full bg-red-200 p-1 text-center"
                    />
                  </td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（E）發出票數（C+D），自動計算</td>
                {calculatedData.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">{item.E}</td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（E）發出票數（G-F），自動計算</td>
                {calculatedData.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">{item.E}</td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">自動檢核</td>
                {calculatedData.map((item, index) => (
                  <td key={index} className={`border border-gray-400 p-2 ${item.consistency === '相符' ? 'text-green-600' : 'text-red-600'}`}>
                    {item.consistency}
                  </td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（A）有效票數（A1+A2），自動計算</td>
                {calculatedData.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">{item.A}</td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（A1）同意票數，手動輸入</td>
                {data.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">
                    <input
                      type="number"
                      value={item.A1 === '' ? '' : item.A1}
                      onChange={(e) => handleInputChange(index, 'A1', e.target.value)}
                      className="w-full bg-red-200 p-1 text-center"
                    />
                  </td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（A2）不同意票數，手動輸入</td>
                {data.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">
                    <input
                      type="number"
                      value={item.A2 === '' ? '' : item.A2}
                      onChange={(e) => handleInputChange(index, 'A2', e.target.value)}
                      className="w-full bg-red-200 p-1 text-center"
                    />
                  </td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（B）無效票，手動輸入</td>
                {data.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">
                    <input
                      type="number"
                      value={item.B === '' ? '' : item.B}
                      onChange={(e) => handleInputChange(index, 'B', e.target.value)}
                      className="w-full bg-red-200 p-1 text-center"
                    />
                  </td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（C）總投票數（A+B），自動計算</td>
                {calculatedData.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">{item.C}</td>
                ))}
              </tr>
              <tr>
                <td className="border border-gray-400 p-2">（D）已領未投票數（G-F-C），自動計算</td>
                {calculatedData.map((item, index) => (
                  <td key={index} className="border border-gray-400 p-2">{item.D}</td>
                ))}
              </tr>
            </tbody>
          </table>
        );
      };

      const renderBottomTable = () => {
        const calculatedData = data.map(calculateValues);
        return (
          <table className="table-auto w-full border-collapse border border-gray-400">
            <thead>
              <tr className="bg-gray-200">
                <th className="border border-gray-400 p-2">編號</th>
                <th className="border border-gray-400 p-2">同意票數A1</th>
                <th className="border border-gray-400 p-2">不同意A2</th>
                <th className="border border-gray-400 p-2">合計A=A1+A2</th>
                <th className="border border-gray-400 p-2">無效票B</th>
                <th className="border border-gray-400 p-2">投票數C=A+B</th>
                <th className="border border-gray-400 p-2">已領未投D</th>
                <th className="border border-gray-400 p-2">發出票數E</th>
                <th className="border border-gray-400 p-2">用餘票數F</th>
                <th className="border border-gray-400 p-2">投票權人數G</th>
              </tr>
            </thead>
            <tbody>
              {calculatedData.map((item, index) => (
                <tr key={index}>
                  <td className="border border-gray-400 p-2">{item.id}</td>
                  <td className="border border-gray-400 p-2">{item.A1}</td>
                  <td className="border border-gray-400 p-2">{item.A2}</td>
                  <td className="border border-gray-400 p-2">{item.A}</td>
                  <td className="border border-gray-400 p-2">{item.B}</td>
                  <td className="border border-gray-400 p-2">{item.C}</td>
                  <td className="border border-gray-400 p-2">{item.D}</td>
                  <td className="border border-gray-400 p-2">{item.E}</td>
                  <td className="border border-gray-400 p-2">{item.F}</td>
                  <td className="border border-gray-400 p-2">{item.G}</td>
                </tr>
              ))}
            </tbody>
          </table>
        );
      };

      return (
        <div>
          <h1 className="text-2xl font-bold mb-4 text-center">2024 選舉投票計算</h1>
          {renderTopTable()}
          {renderBottomTable()}
        </div>
      );
    };

    // 渲染 React 應用
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
```

### 修正內容
1. **修改 `handleInputChange` 函數**：
   - 原邏輯：`const newValue = value === '' ? 0 : parseInt(value) || 0;`
   - 新邏輯：`const newValue = value === '' ? '' : isNaN(parseInt(value)) ? 0 : parseInt(value);`
   - 說明：
     - 允許輸入空字串（`''`），讓使用者可以清空欄位。
     - 如果輸入不是有效數字（`isNaN(parseInt(value))`），設為 `0`。
     - 如果輸入是有效數字（包括 `0`），使用 `parseInt(value)`，確保 `0` 被正確儲存和顯示。

2. **修改輸入欄位顯示**：
   - 原程式碼：`value={item.G || ''}`
   - 新程式碼：`value={item.G === '' ? '' : item.G}`
   - 說明：確保欄位顯示 `0` 而不是空字串，同時允許空字串作為有效輸入。

### 步驟 2：儲存並本地測試
1. **儲存檔案**：
   - 複製上述程式碼，儲存為 `index.html`（推薦，方便 GitHub Pages 訪問）。
   - 使用文字編輯器（例如 VS Code、Notepad++），確保以 UTF-8 編碼儲存。

2. **本地測試**：
   - 由於直接雙擊 HTML 檔案（`file://` 協議）可能因 CORS 限制導致空白，建議使用本地 HTTP 伺服器：
     ```bash
     cd /您的資料夾路徑
     python -m http.server 8000
     ```
   - 在瀏覽器訪問 `http://localhost:8000/index.html`。
   - **測試內容**：
     - 確認表格顯示正常，包含上半部（五個案件）和下半部（總結表）。
     - 在紅底欄位（G、F、A1、A2、B）輸入 `0`，檢查是否正確顯示 `0`。
     - 輸入其他數字（例如 100、500），確認計算欄位（E、A、C、D）即時更新。
     - 清空欄位，確認是否允許空值。
     - 檢查一致性檢核（「相符」或「不相符」）是否正確顯示，顏色是否為綠色（相符）或紅色（不相符）。

3. **檢查控制台**：
   - 如果仍顯示空白，按 F12 > Console，查看是否有錯誤（例如「Failed to load resource」或「React is not defined」）。
   - 確保 CDN 連結正常（需要網路連線）。

### 步驟 3：重新上傳到 GitHub
1. **刪除舊檔案**：
   - 前往 `https://github.com/pipishan1202/election-vote-calculator`。
   - 點擊 `election-vote-calculator.html`（或舊的 `index.html`），選擇「Delete」（垃圾桶圖示），提交變更。

2. **上傳新檔案**：
   - 點擊「Add file」 > 「Create new file」。
   - 檔案名稱輸入 `index.html`。
   - 貼上上述完整程式碼。
   - 提交訊息輸入「Fix input field to allow zero and empty values」，選擇「Commit directly to the main branch」，點擊「Commit new file」。
   - **替代方法**：點擊「Add file」 > 「Upload files」，拖放本地的 `index.html`，提交。

3. **確認上傳**：
   - 檢查儲存庫根目錄，確認 `index.html` 存在且內容正確。

### 步驟 4：檢查 GitHub Pages
1. **確認設置**：
   - 前往 `https://github.com/pipishan1202/election-vote-calculator` > 「Settings」 > 「Pages」。
   - 確保「Source」設置為 `main` 分支，資料夾為 `/ (root)`。
   - 如果已設置，網址應為 `https://pipishan1202.github.io/election-vote-calculator/`。

2. **訪問網頁**：
   - 等待 1-5 分鐘（GitHub Pages 部署可能有延遲）。
   - 訪問 `https://pipishan1202.github.io/election-vote-calculator/`。
   - 測試輸入 `0` 和其他數字，確認是否顯示正常且計算正確。

### 步驟 5：驗證與使用
1. **功能測試**：
   - 確認表格顯示正常，紅底欄位可輸入 `0`、空值或其他數字。
   - 檢查計算欄位（E = G - F, A = A1 + A2, C = A + B, D = G - F - C）是否正確更新。
   - 驗證一致性檢查（「相符」或「不相符」）是否正確顯示。

2. **跨瀏覽器測試**：
   - 在 Chrome、Firefox、Safari 測試，確保輸入和顯示正常。
   - 如果仍有問題，檢查控制台（F12 > Console）。

### 常見問題與解決
- **問題**：輸入 `0` 仍顯示空白。
  - **解決**：確認 `handleInputChange` 使用新邏輯，重新上傳檔案。
- **問題**：網頁仍空白。
  - **解決**：
    - 檢查控制台錯誤（F12 > Console），確認 CDN 是否載入。
    - 使用本地 HTTP 伺服器重新測試（`python -m http.server 8000`）。
    - 確保程式碼完整，特別是 `<script type="text/babel">` 部分。
- **問題**：GitHub Pages 未更新。
  - **解決**：等待 5-10 分鐘，或清除瀏覽器快取（Ctrl+Shift+R）。

### 快速總結
1. 複製上述修正後的程式碼，儲存為 `index.html`。
2. 使用本地 HTTP 伺服器測試（`python -m http.server 8000`），確認可輸入和顯示 `0`。
3. 刪除舊檔案，重新上傳 `index.html` 到 GitHub。
4. 訪問 `https://pipishan1202.github.io/election-vote-calculator/`，測試功能。
5. 分享網址並維護（編輯或重新上傳）。

如果您在本地測試、上傳或線上訪問時仍有問題（例如空白頁面或輸入問題），請提供：
- 瀏覽器控制台錯誤訊息（F12 > Console）。
- 儲存庫中 `index.html` 的內容（確認是否與上述一致）。
我會立即協助！若想改用 Netlify 部署（更簡單），我也可以提供指導。